
(version 1)

(deny default)

(allow file-ioctl
       (literal "/dev/dtracehelper"))

(allow file-read-data file-read-metadata
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/Contents/Frameworks/libcrypto.0.9.8.dylib")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/Contents/Frameworks/libssl.0.9.8.dylib")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/Contents/Frameworks/libz.1.dylib")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/TorBrowser_en-US.app/.tor/state")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/Contents/MacOS/torrc")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/state")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-descriptors.new"))

(allow file-read-data
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-certs")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-consensus")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-descriptors")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-descriptors.new")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/lock")
       (literal "/dev/dtracehelper")
       (literal "/dev/null")
       (literal "/dev/urandom")
       (subpath "/usr/share"))

(allow file-read-metadata
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor")
       (literal "/etc")
       (literal "/private/etc/localtime")
       (subpath "/usr/lib"))

(allow file-write*
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-descriptors")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-descriptors.new")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-descriptors.new.tmp")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-descriptors.tmp")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-descriptors.tmp.tmp")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-consensus")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/cached-consensus.tmp")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/state")
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/state.tmp"))

(allow file-write-data
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/.tor/lock")
       (literal "/dev/dtracehelper"))

(allow ipc-posix-shm)

(allow mach-lookup
       (global-name "com.apple.system.notification_center"))

(allow network-inbound
       (local tcp "localhost:9050")
       (local tcp "localhost:9051"))

(allow network-outbound
       (remote tcp "*:*"))
; we need to allow any port

(allow process-exec
       (literal "/Users/andreas/Downloads/tor/TorBrowser_en-US.app/Contents/MacOS/tor-bin"))

(allow sysctl-read)
